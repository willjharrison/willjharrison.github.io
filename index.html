<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sensory Intelligence Research Group</title>
  <meta name="description" content="Sensory Intelligence Research Group — minimal, responsive landing page." />

  <style>
    :root{
      /* Core palette */
      --bg: #F5F5F5;
      --fg: #523D3D;
      --accent: #E0AFD2;
      --muted: #A64B32;

      /* Menu colours */
      --menu-fg: #006CBD;                /* button text */
      --menu-border: #172E3B;            /* button border */
      --menu-bg: transparent;              /* default background */
      --menu-hover-bg: #A6D1FF;      /* background on hover */
      --menu-hover-fg: #376A9E;               /* text on hover */
      --menu-active-bg: #EA96FF;     /* background when active */
      --menu-active-fg: #94003A;           /* text when active */

      /* Fonts and sizing */
      --font-main: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      --title-size: clamp(2rem, 4vw, 3rem);
      --subtitle-size: clamp(1rem, 2.4vw, 1.35rem);
      --max-w: 1200px;
      --pad-x: clamp(16px, 4vw, 40px);
      --gap: 22px;
    }

    body{
      margin:0; background:var(--bg); color:var(--fg); font-family:var(--font-main);
      display:flex; flex-direction:column; min-height:100vh;
    }

    header{
      position:sticky; top:0; z-index:10; background:var(--bg);
      padding: var(--pad-x) var(--pad-x) calc(var(--gap) * 1.2);
      text-align:center;
    }
    .title{ font-size:var(--title-size); margin:0 0 var(--gap) 0; }
    .subtitle{ font-size:var(--subtitle-size); color:var(--muted); margin:0 0 var(--gap) 0; }

    /* Menu buttons */
    .actions{
      display:flex; gap:8px; justify-content:center; flex-wrap:nowrap;
      overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:thin;
      padding-bottom:2px;
    }
    .btn{
      flex:0 0 auto;
      padding:10px 16px;
      border:1px solid var(--menu-border);
      border-radius:6px;
      text-decoration:none;
      color:var(--menu-fg);
      background:var(--menu-bg);
      cursor:pointer;
      white-space:nowrap;
      transition: background .2s, color .2s;
    }
    .btn:hover{
      background:var(--menu-hover-bg);
      color:var(--menu-hover-fg);
    }
    .btn.active{
      background:var(--menu-active-bg);
      color:var(--menu-active-fg);
      font-weight:bold;
    }

    main{ flex:1; max-width:var(--max-w); margin:0 auto; padding:0 var(--pad-x); }
    #content{
      margin-top:calc(var(--gap)*1.5);
      text-align:left; max-width:760px; margin-left:auto; margin-right:auto;
      white-space:normal; line-height:1.45;
    }

    #content h1, #content h2, #content h3{
      text-align:center; font-weight:700; margin: 1em 0 0.5em;
    }
    #content p{ margin: 0.35em 0 0.5em; }

    /* Collapsibles */
    #content details{
      margin: 0.5em 0;
      border: 1px solid color-mix(in srgb, var(--muted) 70%, transparent);
      border-radius:6px;
      padding: 0.35em 0.55em;
      background: color-mix(in srgb, var(--accent) 50%, transparent);
    }
    #content details[open]{ background: color-mix(in srgb, var(--accent) 50%, transparent); }
    #content details > summary{
      cursor:pointer; font-weight:700; list-style:revert;
      margin:0; padding:0.15em 0;
    }
    #content details > summary + *{ margin-top:0.25em !important; }
    #content details p{ margin: 0.25em 0 0.5em; }

    footer{ text-align:center; padding:20px; font-size:.9rem; opacity:.7; margin-top:auto; }
    .hidden{ display:none; }
  </style>
</head>
<body>
  <header>
    <h1 class="title">Sensory Intelligence Research Group</h1>
    <p class="subtitle">From neurons to behaviour through computation and experiment.</p>
    <nav class="actions" aria-label="Primary">
      <a class="btn" href="#about"        data-file="about.txt"           data-title="About">About</a>
      <a class="btn" href="#research"     data-file="research-topics.txt" data-title="Research Themes">Research Themes</a>
      <a class="btn" href="#pushingback"  data-file="pushingback.txt"     data-title="Pushing back on AI">Pushing Back On A.I.</a>
      <a class="btn" href="#publications" data-file="publications.txt"    data-title="Publications">Publications</a>
      <a class="btn" href="#collaborators"data-file="collaborators.txt"   data-title="Collaborators">Collaborators</a>
      <a class="btn" href="#opportunities"data-file="opportunities.txt"   data-title="Opportunities">Opportunities</a>
    </nav>
  </header>

  <main>
    <section id="content" class="hidden" aria-live="polite"></section>
  </main>

  <footer>
    © <span id="y"></span> Sensory Intelligence Research Group · Will Harrison, University of the Sunshine Coast
  </footer>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const contentEl = document.getElementById('content');
    const buttons   = document.querySelectorAll('.actions .btn[data-file]');
    const TXT_CACHE = new Map();

    async function prefetchAll(){
      const unique = [...new Set(Array.from(buttons, b => b.getAttribute('data-file')))].filter(Boolean);
      await Promise.all(unique.map(async (path) => {
        try{
          const res = await fetch(path, {cache: 'no-store'});
          if (!res.ok) return;
          const txt = (await res.text()).trim();
          TXT_CACHE.set(path, txt);
        }catch(_){}
      }));
    }

    function setLoading(label){
      contentEl.classList.remove('hidden');
      contentEl.textContent = `Loading ${label}…`;
    }
    
    function wireAccordion(root){
      const items = root.querySelectorAll('details');
      if (!items.length) return;
      items.forEach(d => {
        d.addEventListener('toggle', () => {
          if (!d.open) return;
          items.forEach(other => { if (other !== d) other.removeAttribute('open'); });
        });
      });
    }
    
    async function loadText(path, label){
      let txt;
      if (TXT_CACHE.has(path)){
        txt = TXT_CACHE.get(path);
      } else {
        try{
          setLoading(label);
          const res = await fetch(path, {cache: 'no-store'});
          if(!res.ok) throw new Error(`${res.status} ${res.statusText}`);
          txt = (await res.text()).trim();
          TXT_CACHE.set(path, txt);
        }catch(err){
          contentEl.textContent = `Could not load ${label}. (${err.message})`;
          return;
        }
      }
      contentEl.classList.remove('hidden');
      contentEl.innerHTML = txt || `(No content in ${path})`;
      wireAccordion(contentEl);  // <- ensures only one details stays open
    }

    function handleClick(ev){
      const a = ev.currentTarget;
      const file  = a.getAttribute('data-file');
      const label = a.getAttribute('data-title') || a.textContent.trim();
      ev.preventDefault();
      history.replaceState(null, '', a.getAttribute('href'));

      buttons.forEach(btn => btn.classList.remove('active'));
      a.classList.add('active');

      loadText(file, label);
    }

    buttons.forEach(a => a.addEventListener('click', handleClick));

    function bootFromHash(){
      const hash = location.hash.replace('#','');
      if(!hash) return;
      const target = Array.from(buttons).find(a => a.getAttribute('href') === `#${hash}`);
      if (target) target.click();
    }
    window.addEventListener('hashchange', bootFromHash);

    prefetchAll().then(bootFromHash);
  </script>
</body>
</html>
