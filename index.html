<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Computational Intelligence Research</title>
  <meta name="color-scheme" content="dark light" />
  <style>
    :root {
      --bg:#000; --fg:#b6fdb6; --glow:#19ff19;
      /* Rain color: lower saturation = more desaturated */
      --rainColor: hsla(120, 60%, 60%, 1);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:hidden}

    /* Fullscreen matrix canvas */
    #matrix{position:fixed;inset:0;z-index:0;display:block;width:100%;height:100%;background:radial-gradient(1200px 800px at 50% 50%, #001600 0%, #000 80%)}

    /* Title bar pinned to top */
    .wrap{position:fixed;top:0;left:0;right:0;display:flex;justify-content:center;align-items:flex-start;padding:16px 20px;z-index:1}

    h1{margin:0;text-align:center;letter-spacing:.06em;font-weight:700;font-size:clamp(22px,5.5vw,72px);text-shadow:0 0 .6rem var(--glow),0 0 1.2rem var(--glow),0 0 2.4rem var(--glow);filter:contrast(1.05) saturate(1.1) drop-shadow(0 0 .25rem #0a460a)}

    /* CRT scanlines */
    .crt{position:relative;isolation:isolate}
    .crt::before{content:"";position:absolute;inset:-2px;z-index:2;background:repeating-linear-gradient(to bottom,transparent 0 2px,rgba(255,255,255,.03) 2px 3px);mix-blend-mode:overlay;pointer-events:none;animation:scan 7s linear infinite}
    .crt::after{content:"";position:absolute;inset:-2px;z-index:1;background:radial-gradient(ellipse at center, rgba(0,255,0,.12), transparent 60%);pointer-events:none;filter:blur(2px)}
    @keyframes scan{0%{transform:translateY(-5%);opacity:.6}50%{opacity:.25}100%{transform:translateY(5%);opacity:.6}}

    footer{position:fixed;inset:auto 0 8px 0;text-align:center;font-size:12px;opacity:.55;z-index:1}

    @media (prefers-reduced-motion: reduce){.crt::before{animation:none}#matrix{display:none}}
  </style>
</head>
<body>
  <canvas id="matrix" aria-hidden="true"></canvas>

  <div class="wrap">
    <!-- Ghosting removed: no 'glitch' class, no data-text attribute -->
    <h1 id="title" class="crt">Computational Intelligence Research</h1>
  </div>

  <footer>© <span id="y"></span> CIR</footer>

  <script>
    // ===== Matrix rain (robust sizing + tweakable knobs + red pulse) =====
    (() => {
      const c = document.getElementById('matrix');
      const ctx = c.getContext('2d');
      let w, h, cols, drops, speeds, dpr, fontSize, pulseTimers;

      /* Decay rate of trails: lower = longer trails, higher = quicker fade */
      const RAIN = { speed: .4, variability: 2, resetChance: 0.75, trail: 0.050 };
      const glyphs = 'アイウエオカキクケコサシスセソ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$%&*';

      function resize(){
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
        w = window.innerWidth; h = window.innerHeight;
        c.width = Math.floor(w*dpr); c.height = Math.floor(h*dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
        fontSize = Math.max(12, Math.floor(w/90));
        ctx.font = fontSize + 'px monospace';
        ctx.textBaseline = 'top';
        cols = Math.max(1, Math.ceil(w / fontSize));
        drops = Array(cols).fill(0).map(()=>Math.random()*-50);
        speeds = Array(cols).fill(0).map(()=>0.6 + Math.random()*RAIN.variability);
        pulseTimers = Array(cols).fill(0); // per-column red pulse alpha (0..1)
      }
      window.addEventListener('resize', resize, {passive:true});
      resize();

      function draw(){
        if(!document.hidden){
          // Background fade — tied to RAIN.trail above
          ctx.fillStyle = `rgba(0,20,0,${RAIN.trail})`;
          ctx.fillRect(0,0,w,h);

          const rainColor = getComputedStyle(document.documentElement).getPropertyValue('--rainColor').trim();

          for(let i=0;i<cols;i++){
            const ch = glyphs[Math.floor(Math.random()*glyphs.length)];
            const x = i * fontSize;
            const y = drops[i] * fontSize;

            // ----- Red pulse effect -----
            if (pulseTimers[i] > 0) {
              ctx.fillStyle = `rgba(105,200,60,${pulseTimers[i].toFixed(3)})`;
              pulseTimers[i] = Math.max(0, pulseTimers[i] - 0.02); // decay
            } else if (Math.random() < 0.06) { // trigger probability per frame/column
              pulseTimers[i] = 1; // start at full red
              ctx.fillStyle = 'rgba(100,200,100,.6)';
            } else {
              ctx.fillStyle = rainColor; // normal green
            }

            ctx.fillText(ch, x, y);

            if(y > h && Math.random() > RAIN.resetChance) {
              drops[i] = -Math.random()*20;
            } else {
              const jitter = Math.random()*2; // extra variability in pace
              drops[i] += RAIN.speed * speeds[i] * jitter;
            }
          }
        }
        requestAnimationFrame(draw);
      }
      draw();
      window.CIR_RAIN = RAIN;
    })();

    // ===== Title pulse (random timing & amplitude) =====
    (()=>{
      const el = document.getElementById('title');
      function pulseOnce(){
        const dur = 200 + Math.random()*200; // quick, subtle
        const amp = 1 + Math.random()*0.08;
        const bright = 0.85 + Math.random()*0.3; // 0.85–1.15
        el.animate([
          { transform:'scale(1)',           filter:`brightness(${bright})` },
          { transform:`scale(${amp})`,      filter:`brightness(${Math.min(1.25, bright+0.1)})` },
          { transform:'scale(1)',           filter:`brightness(${bright})` }
        ], { duration: dur, easing:'ease-in-out' });
      }
      (function schedule(){
        const wait = 500 + Math.random()*3500;
        setTimeout(()=>{ pulseOnce(); schedule(); }, wait);
      })();
    })();

    // ===== Subtle micro-jitter (no ghost layers) =====
    (()=>{
      const el = document.getElementById('title');
      const meanMs = 1200; // average interval (lower = more frequent)
      const expRand = m => -Math.log(1-Math.random())*m;
      function jitterOnce(){
        const nudgeX = (Math.random()*2-1)*1;
        const nudgeY = (Math.random()*2-1)*1;
        const scale  = 1 + Math.random()*0.015;
        el.style.transform = `translate(${nudgeX}px,${nudgeY}px) scale(${scale})`;
        setTimeout(()=>{ el.style.transform=''; }, 140 + Math.random()*180);
      }
      (function schedule(){ setTimeout(()=>{ jitterOnce(); schedule(); }, expRand(meanMs)); })();
    })();

    // Year stamp
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
